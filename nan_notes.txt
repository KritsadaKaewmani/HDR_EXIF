a copy of py code from FLG